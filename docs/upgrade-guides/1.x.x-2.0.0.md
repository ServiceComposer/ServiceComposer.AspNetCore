# Upgrade guide from v1.x to v2.0.0

<!-- toc -->
## Contents

  * [Target frameworks](#target-frameworks)
  * [Compostition Gateway is legacy](#compostition-gateway-is-legacy)
  * [Moving from IRouteBuilder to ASP.Net Core Endopints](#moving-from-iroutebuilder-to-aspnet-core-endopints)
  * [Composition handlers API changes](#composition-handlers-api-changes)
    * [IHandleRequests -> ICompositionRequestsHandler](#ihandlerequests---icompositionrequestshandler)
    * [IPublishCompositionEvents -> ICompositionEventsPublisher](#ipublishcompositionevents---icompositioneventspublisher)
    * [ISubscribeToCompositionEvents -> ICompositionEventsSubscriber](#isubscribetocompositionevents---icompositioneventssubscriber)
    * [IHandleRequestsErrors -> ICompositionErrorsHandler](#ihandlerequestserrors---icompositionerrorshandler)
  * [DynamicViewModel RaiseEvent -> ICompositionContext](#dynamicviewmodel-raiseevent---icompositioncontext)
  * [MapCompositionHandlers write support](#mapcompositionhandlers-write-support)
  * [IViewModelPreviewHandler Preview](#iviewmodelpreviewhandler-preview)
  * [Route matching](#route-matching)<!-- endToc -->

## Target frameworks

Starting with version 2.0.0 the `ServiceComposer.AspNetCore` package targets only the following frameworks

- net6.0
- net7.0

## Compostition Gateway is legacy

The `RunCompositionGateway` API is deprecated in favor of explict ASP.Net endpoint configuration; Use the new endpoints mapping API:

<!-- snippet: run-composition-gateway-deprecation -->
<a id='snippet-run-composition-gateway-deprecation'></a>
```cs
public void Configure(IApplicationBuilder app, ILoggerFactory loggerFactory)
{
    app.UseRouting();
    app.UseEndpoints(builder => builder.MapCompositionHandlers());
}
```
<sup><a href='/src/Snippets/UpgradeGuides/1.x-to-2.0/UpgradeGuide.cs#L11-L17' title='Snippet source file'>snippet source</a> | <a href='#snippet-run-composition-gateway-deprecation' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

## Moving from IRouteBuilder to ASP.Net Core Endopints

## Composition handlers API changes

### IHandleRequests -> ICompositionRequestsHandler

### IPublishCompositionEvents -> ICompositionEventsPublisher

### ISubscribeToCompositionEvents -> ICompositionEventsSubscriber

### IHandleRequestsErrors -> ICompositionErrorsHandler

## DynamicViewModel RaiseEvent -> ICompositionContext

DynamicViewModel stopped imnplementing ICompositionContext

## MapCompositionHandlers write support

## IViewModelPreviewHandler Preview

## Route matching

When using composition over controllers route matching is now case insensitive by default. The previous behavior can be configured via the composition over controllers options.
